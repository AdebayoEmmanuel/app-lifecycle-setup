apiVersion: v1
kind: ConfigMap
metadata:
  name: service-config
  namespace: ecommerce
  labels:
    app: ecommerce
    component: config
data:
  # Service URLs for internal communication
  PRODUCT_SERVICE_URL: "http://product-service:8080"
  ORDER_SERVICE_URL: "http://order-service:8080"
  API_GATEWAY_URL: "http://api-gateway-active:80"
  
  # Upstream configuration for nginx
  nginx.conf: |
    upstream product_backend {
        server product-service:8080;
    }
    
    upstream order_backend {
        server order-service:8080;
    }
    
    server {
        listen 80;
        
        location /products {
            proxy_pass http://product_backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        
        location /orders {
            proxy_pass http://order_backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        
        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
    }
